head(Thera_Bank)
tail(Thera_Bank)
summary(Thera_Bank)
plot(Thera_Bank$`Experience (in years)`)
plot(Thera_Bank)
hist(Thera_Bank$`Experience (in years)`)
boxplot(Thera_Bank$`Income (in K/month)`)
boxplot(Thera_Bank)
View(Thera_Bank)
dim(Thera_Bank)
attach(Thera_Bank)
complete.cases(Thera_Bank)
Thera_Bank = Thera_Bank[complete.cases(Thera_Bank),]
dim(Thera_Bank)
table(Thera_Bank$`Personal Loan`)
prop.table(table(Thera_Bank$`Personal Loan`))
round(prop.table(table(Thera_Bank$`Personal Loan`)),3)
plot(Thera_Bank$`Age (in years)`, Thera_Bank$`Income (in K/month)`)
points(Thera_Bank$`Age (in years)`[Thera_Bank$`Experience (in years)`=="Good"],Thera_Bank$`Income (in K/month)`[Thera_Bank$`Experience (in years)`=="Good"],col="green",pch=19)
points(Thera_Bank$`Age (in years)`[Thera_Bank$`Experience (in years)`=="Bad"],Thera_Bank$`Income (in K/month)`[Thera_Bank$`Experience (in years)`=="Bad"],col="Yellow",pch=19) 
library(caTools)
set.seed(123)
split = sample.split(Thera_Bank$`Personal Loan`,SplitRatio = 0.70)
trainThera_Bank= subset(Thera_Bank, split == TRUE)
testThera_Bank = subset(Thera_Bank, split == FALSE)
dim(trainThera_Bank)
dim(testThera_Bank)
round(prop.table(table(trainThera_Bank$`Personal Loan`)),2)
round(prop.table(table(testThera_Bank$`Personal Loan`)),2)
library(rpart)
library(rpart.plot)
set.seed(123)
tree <- rpart(formula = `Personal Loan`~., data = trainThera_Bank, method = "class", cp = 0, minbucket = 3)
rpart.plot(tree)
printcp(tree)
plotcp(tree)
tree = prune(tree, cp = 0.3014925)
tree
rpart.plot(tree)
printcp(tree)
trainThera_Bank$prediction = predict(tree, trainThera_Bank, type ="class" )
trainThera_Bank$prediction = predict(tree, trainThera_Bank, type = "prob")
View(trainThera_Bank)
trainThera_Bank = with(trainThera_Bank, table(`Age (in years)`, trainThera_Bank$prediction))
trainThera_Bank
trainThera_Bank[1,1]
library(ROCR)
predict = prediction(trainThera_Bank$`Income (in K/month)`,trainThera_Bank$`Personal Loan`)
perf = performance(predict,"tpr", "fpr")
plot(perf, col ="Brown", main = "ROC Plot- trainThera_Bank")
abline(0,1, lty =8, col = "orange")
cart.trainThera_Bank.auc = performance(predict,"auc")
cart.trainThera_Bank.auc = cart.trainThera_Bank.auc@y.values
cart.trainThera_Bank.auc
cart.trainThera_Bank.KS = max(perf@y.values[[1]]-perf@x.values[[1]])
cart.trainThera_Bank.KS
predict1 = prediction1(testThera_Bank$`Income (in K/month)`,testThera_Bank$`Personal Loan`)
performance1 = performance1(prediction1, "tpr", "fpr")
plot(performance1, col ="Black", main = "ROC Plot- testThera_Bank")
abline(0,1, lty =8, col = "yellow")
cart.testThera_Bank.KS = max(performance1@y.values[[1]]-perf1@x.values[[1]])
cart.testThera_Bank.auc = performance1(predict1,"auc")
cart.testThera_Bank.auc = as.numeric(cart.testThera_Bank.auc@y.values)
cart.testThera_Bank.KS
cart.testThera_Bank.auc

